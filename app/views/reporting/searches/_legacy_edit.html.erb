<%= render :partial => "shared/tab/reporting", :locals => {:selected => "Searches"} %>
<div style="background-color:#fff; height:1500px">
<div class="navbar">
    <div class="navbar-inner"><h4 style="color:black">Searches</h4></div>
</div>
<div style="float:left; width:175px; height:700px;">
  <br /><br /><br /><i class="icon-plus-sign icon-blue"></i>
  <%= link_to "New Search Record", new_reporting_search_path, :remote => true   %><br />
  <i class="icon-plus-sign icon-blue"></i> 
  <%= link_to "New Legacy Search", legacy_new_reporting_searches_path, :remote => true   %><br />
  &nbsp;<%= link_to "All Legacy Searches", "reporting/searches/legacy_index", :remote => true %>
</div>
<div id="tag_keys" style="float:right; background-color:#d9deec; color:#000; width:80%; height:700px; overflow: auto;  ">
  <%= form_for(@legacy_search, :url => {:action => 'legacy_update', :id => @legacy_search.id }, :remote => true) do |f| %>
  
	<div class="navbar">
		<div class="navbar-inner">
		  <h4 style="color:black; height:5px;" >Search Criteria
		  <div style="font-size:15px; float:right;">Search Name:<%= f.text_field "search_name", :style => "width:150px" %></div></h4>
		</div>
	</div>	
	<div class="row">
		<div class="span4">
			<table>
				<tr >
				  <td style="width:10%"></td>
				  <td>First:</td>
				  <td><%= f.text_field "first_name", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="10%"></td>
				  <td>Middle:</td>
				  <td><%= f.text_field "middle_name", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>Last:</td>
				  <td><%= f.text_field "last_name", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>City:</td>
				  <td><%= f.text_field "city", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>State:</td>
				  <td><%= f.select "state_id", options_from_collection_for_select(@states, "id", "abbrev"), {:include_blank => 'None'}, :style => "width:70px" %>
				  Zip:
				  <%= f.text_field "zip", :style => "width:40px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>Phone:</td>
				  <td><%= f.text_field "phone", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>Email:</td>
				  <td><%= f.text_field "email", :style => "width:150px" %></td>
				</tr>
				<tr >
				  <td style="width:10%"></td>
				  <td>Age Between:</td>
				  <td><%= f.text_field "age_from", :style => "width:50px" %>
				  And:<%= f.text_field "age_to", :style => "width:50px" %>
				  </td>
				</tr>
				</table>
		</div>
		<div class="span4">
			<table>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Campaign:</td>
				  <td><%= f.select "campaign_id", options_from_collection_for_select(@campaigns, "id", "name"), {:include_blank => 'None'}, :style => "width:135px" %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Source:</td>
				  <td><%= f.select "source","", {:include_blank => 'None'}, :style => "width:135px" %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>IC:</td>
				  <td><%= form_tag do %>
				        <%= autocomplete_field_tag :i_c,"", autocomplete_usage_user_login_reporting_searches_path, :id_element => '#reporting_searches_ic', :style => "width:120px" %>
				      <% end %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Sales Support:</td>
				  <td>
				  <%= form_tag do %>
				    <%= autocomplete_field_tag :sales_support_id, '', autocomplete_usage_role_name_reporting_searches_path, :id_element => '#reporting_searches_sales_support', :style => "width:120px" %>
				  <% end %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Agent of Record:</td>
				  <td>
				  <%= form_tag do %>
				    <%= autocomplete_field_tag :agent_name, '', autocomplete_usage_user_first_name_reporting_searches_path, :id_element => '#reporting_searches_agent', :style => "width:120px" %>
				  <% end %></td>
				</tr>
				<tr class="field">
				  <td style="width:5%"></td>
				  <td>Carrier Name:</td>
				  <td><%= f.text_field "carrier_name", :style => "width:125px" %></td>
				</tr>
			  </table>
		</div>
		<div class="span4">
			<table>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Lead Type:</td>
				  <td><%= f.select "lead_type","", {:include_blank => 'None'}, :style => "width:135px" %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Profile:</td>
				  <td><%= f.select "profile_id", options_from_collection_for_select(@profiles, "id", "name"), {:include_blank => 'None'}, :style => "width:135px" %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Policy Type:</td>
				  <td><%= f.select "policy_type_id", options_from_collection_for_select(@policies, "id", "name"), {:include_blank => 'None'}, :style => "width:135px" %></td>
				</tr>	
				<tr>
				  <td></td>
				  <td>Between</td>
				  <td>And</td>
				</tr>
				<tr>
				  <td colspan="3"><hr /></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Face Amount:</td>
				  <td><%= f.select "face_amount_from", options_for_select(APP_CONFIG['face_amounts'].map{|x| [number_to_currency(x, precision:0),x]}), {:include_blank => 'None'}, :style => "width:100px" %>
				  	  <%= f.select "face_amount_to", options_for_select(APP_CONFIG['face_amounts'].map{|x| [number_to_currency(x, precision:0),x]}), {:include_blank => 'None'}, :style => "width:100px" %></td>
				</tr>
				<tr class="field">
				  <td style="width:10%"></td>
				  <td>Annual Premium:</td>
				  <td><%= f.text_field "annual_premium_from", :style => "width:87px" %>
				  	  <%= f.text_field "annual_premium_to", :style => "width:87px" %></td>
				</tr>			
			</table>
		</div>
	</div>
	<center>Between</center><hr />  
      	<div class="span4">
	<table>
	  <tr>
	    <td></td>
	    <td><input type="reset" name="clear" id="search" value="Clear Search"></td>
	    <td><%= f.submit "Run Search", :style => "width:100px" %></td>
	    <td><%= f.submit "Save Search", :style => "width:100px" %></td>
	  </tr>
	  <tr>
	    <td></td>
	    <td colspan=2><center>Policy Created</center></td>
           <td><%= form_tag( search_policy_create_date_reporting_searches_url , :remote => true, :id => "search_policy_create_date", 
                    :class => "search_policy_create_date ajax" , :method => :get, :style=>"margin: 10px 0;" ) do  %>
            <fieldset>
            <div class="control-group">
              <div class="controls">
                <div class="input-prepend">
                  <input type="hidden" name="from_date" id="from-date-range">
                  <input type="hidden" name="to_date" id="to-date-range">
                  <input type="text" value="04/04/2012 - 04/04/2013" name="policies-date-range-field" id="policies-date-range-field" readonly>
                  <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
              </div>
            </div>
            </fieldset>
           <% end %>
        </td>
      <tr>
        <td><%= f.check_box "app_status" %></td>
	<td><%= f.label("app_status", "App Submitted Status") %></td>
	<td><%#= f.check_box "current", :disabled => true %>
		<%#= f.label("current", "Currently") %></td>	
	<td><%= form_tag( search_policy_create_date_reporting_searches_url , :remote => true, :id => "search_policy_create_date2", :class => "search_policy_create_date2 ajax" , :method => :get, :style=>"margin: 10px 0;" ) do  %>
          <fieldset>
            <div class="control-group">
              <div class="controls">
                <div class="input-prepend">
                  <input type="hidden" name="from_date" id="from-date-range">
                  <input type="hidden" name="to_date" id="to-date-range">
                  <input type="text" value="04/04/2012 - 04/04/2013" name="policies-date-range-field" id="policies-date-range-field2" readonly>
                  <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
              </div>
            </div>
          </fieldset>
        <% end %>
	</td>
      </tr>
      <tr>
        <td></td>
	<td><%= f.select "status_category_id", options_from_collection_for_select(@openness, "id", "name"), {:include_blank => "Status Category"}, :style => "width:150px" %></td>
	<td></td>
	<td><%= form_tag( search_policy_create_date_reporting_searches_url , :remote => true, :id => "search_policy_create_date3", :class => "search_policy_create_date ajax" , :method => :get, :style=>"margin: 10px 0;" ) do  %>
            <fieldset>
            <div class="control-group">
              <div class="controls">
                <div class="input-prepend">
                  <input type="hidden" name="from_date" id="from-date-range">
                  <input type="hidden" name="to_date" id="to-date-range">
                  <input type="text" value="04/04/2012 - 04/04/2013" name="policies-date-range-field" id="policies-date-range-field3" readonly>
                  <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
              </div>
            </div>
            </fieldset>
           <% end %>
	</td>
      </tr>
      <tr>
        <td></td>
	<td><%= f.select "status_id", options_from_collection_for_select(@status, "id", "name"), {:include_blank => 'Status Type'}, :style => "width:150px" %></td>
	<td></td>
	<td><%= form_tag( search_policy_create_date_reporting_searches_url , :remote => true, :id => "search_policy_create_date4", :class => "search_policy_create_date ajax" , :method => :get, :style=>"margin: 10px 0;" ) do  %>
            <fieldset>
            <div class="control-group">
              <div class="controls">
                <div class="input-prepend">
                  <input type="hidden" name="from_date" id="from-date-range">
                  <input type="hidden" name="to_date" id="to-date-range">
                  <input type="text" value="04/04/2012 - 04/04/2013" name="policies-date-range-field" id="policies-date-range-field4" readonly>
                  <span class="add-on"><i class="icon-calendar"></i></span>
                </div>
              </div>
            </div>
            </fieldset>
           <% end %>
	</td>
      </tr>
   </table>
	<% end -%>
</div>
</div><br /><br /><br /><br />

<div id="legacy_results">
</div>

<script>
    
 $("#app_status").click(function(){
   $("#current").attr("enabled", $(this).is(":checked"));
  });
  $(function(){
    $('.activity_date').editable({
      format: 'MMMM DD YYYY h:mm a',
      viewformat: 'YYYY-MM-DD',
      template: 'D / MMMM / YYYY h:mm a',
      ajaxOptions: {
        type: 'PUT',
      }
    });
    
    $('.activity_status').editable({
      ajaxOptions: {
        type: 'PUT',
      }
    });
    
    $('.activity_description').editable({
      title: 'Enter description',
      rows: 4,
      ajaxOptions: {
        type: 'PUT',
      }
    });
  });

  $(function() {
    $( "#from" ).datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function( selectedDate ) {
        $( "#to" ).datepicker( "option", "minDate", selectedDate );
      }
    });
    $( "#to" ).datepicker({
      defaultDate: "+1w",
      changeMonth: true,
      numberOfMonths: 3,
      onClose: function( selectedDate ) {
        $( "#from" ).datepicker( "option", "maxDate", selectedDate );
      }
    });
    $('#policies-date-range-field').daterangepicker('change',function(start, end){
      $("#from-date-range").val(start.toString('MMMM d, yyyy'));
      $("#to-date-range").val(end.toString('MMMM d, yyyy'));
      $("#search_policy_create_date.ajax").submit();
    });
    $('#policies-date-range-field2').daterangepicker('change',function(start, end){
      $("#from-date-range").val(start.toString('MMMM d, yyyy'));
      $("#to-date-range").val(end.toString('MMMM d, yyyy'));
      $("#search_policy_create_date.ajax").submit();
    });
    $('#policies-date-range-field3').daterangepicker('change',function(start, end){
      $("#from-date-range").val(start.toString('MMMM d, yyyy'));
      $("#to-date-range").val(end.toString('MMMM d, yyyy'));
      $("#search_policy_create_date.ajax").submit();
    });
    $('#policies-date-range-field4').daterangepicker('change',function(start, end){
      $("#from-date-range").val(start.toString('MMMM d, yyyy'));
      $("#to-date-range").val(end.toString('MMMM d, yyyy'));
      $("#search_policy_create_date.ajax").submit();
    });
  });  
  
</script>
